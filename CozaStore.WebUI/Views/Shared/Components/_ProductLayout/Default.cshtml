@model List<ResultProductDto>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<section class="bg0 p-t-23 p-b-140">
	<div class="container">
		<div class="p-b-10">
			<h3 class="ltext-103 cl5">
				ÜRÜNLERİMİZ
			</h3>
		</div>

		<div class="flex-w flex-sb-m p-b-52">
			<div class="flex-w flex-l-m filter-tope-group m-tb-10">
			</div>
		</div>

		<div class="row isotope-grid">
			@foreach (var item in Model)
			{
				<div class="col-sm-6 col-md-4 col-lg-3 p-b-35 isotope-item women">
					<div class="block2">
						<div class="block2-pic hov-img0" style="width:315px; height:315px">
							<img src="@item.ImageUrl" alt="IMG-PRODUCT">

							<a data-id="@item.ProductId" class="block2-btn flex-c-m stext-103 cl2 size-102 bg0 bor2 hov-btn1 p-lr-15 trans-04 js-show-modal1">
								Detaylar
							</a>
						</div>

						<div class="block2-txt flex-w flex-t p-t-14">
							<div class="block2-txt-child1 flex-col-l ">
								<a href="" class="stext-104 cl4 hov-cl1 trans-04 js-name-b2 p-b-6">
									@item.ProductName
								</a>

								<span class="stext-105 cl3">
									@item.Price₺
								</span>
							</div>

							<div class="block2-txt-child2 flex-r p-t-3">
								<a href="#" class="btn-addwish-b2 dis-block pos-relative js-addwish-b2">
									<img class="icon-heart1 dis-block trans-04" src="~/cozastore-master/images/icons/icon-heart-01.png" alt="ICON">
									<img class="icon-heart2 dis-block trans-04 ab-t-l" src="~/cozastore-master/images/icons/icon-heart-02.png" alt="ICON">
								</a>
							</div>
						</div>
					</div>
				</div>
			}
		</div>
	</div>
</section>

<!-- Modal1 -->
<div class="wrap-modal1 js-modal1 p-t-60 p-b-20">
	<div class="overlay-modal1 js-hide-modal1"></div>

	<div class="container">
		<div class="bg0 p-t-60 p-b-30 p-lr-15-lg how-pos3-parent">
			<button class="how-pos3 hov3 trans-04 js-hide-modal1">
				<img src="~/cozastore-master/images/icons/icon-close.png" alt="CLOSE">
			</button>

			<div class="row" id="modalContent">
				<div class="col-md-6 col-lg-7 p-b-30">
					<div class="p-l-25 p-r-30 p-lr-0-lg">
						<div class="wrap-slick3 flex-sb flex-w">
							<div class="wrap-slick3-dots"></div>
							<div class="wrap-slick3-arrows flex-sb-m flex-w"></div>

							<div class="slick3 gallery-lb">
								<div class="item-slick3" id="modalImageContainer" data-thumb="">
									<div class="wrap-pic-w pos-relative">
										<img src="" class="modalImage" alt="IMG-PRODUCT" style="width:600px;height:600px">

										<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04 modalImageLink" href="">
											<i class="fa fa-expand"></i>
										</a>
									</div>
								</div>
							</div>

						</div>
					</div>
				</div>

				<div class="col-md-6 col-lg-5 p-b-30">
					<div class="p-r-50 p-t-5 p-lr-0-lg">
						<h4 class="mtext-105 cl2 js-name-detail p-b-14" id="productName">
						</h4>

						<span class="mtext-106 cl2">
							Fiyat: &nbsp; <span id="productPrice"></span>
						</span>
						<br /><br />
						<p class="mtext-106 cl2">
							Ürün Detayı:
							<br />
							<span class="stext-102 cl3 p-t-23" id="detail">

							</span>
						</p>

					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
			$(document).ready(function () {
		$(".block2-btn").on("click", function () {
			var productId = $(this).data("id");

			// Modal içeriğini temizle (önceki ürün görselleri ve bilgiler)
			$("#productName").text("");
			$(".modalImage").attr("src", ""); // Görseli sıfırla
			$("#productPrice").text("");
			$("#detail").text("");
			$("#modalImageContainer").attr("data-thumb", ""); // data-thumb sıfırla
			$(".modalImageLink").attr("href", ""); // href sıfırla

			$.ajax({
				url: '/Product/GetProductDetails',
				type: 'GET',
				data: { id: productId },
				success: function (data) {
					// Modal içeriğini doldur
					$("#productName").text(data.productName);
					$("#productPrice").text(data.price + " ₺");
					$("#detail").text(data.detail);
					$(".modalImage").attr("src", data.imageUrl); // Görseli yükle
					$("#modalImageContainer").attr("data-thumb", data.imageUrl); // data-thumb doldur
					$(".modalImageLink").attr("href", data.imageUrl); // Büyük görsel linki

					// Modalı göster
					$(".js-modal1").addClass("show-modal");

					// Slick3 galerisinde sadece tıklanan ürünün fotoğrafını ekle
					$(".slick3").slick('slickRemove', null, null, true); // Önceki fotoğrafları kaldır
					$(".slick3").slick('slickAdd',
						`<div class="item-slick3" data-thumb="${data.imageUrl}">
							<div class="wrap-pic-w pos-relative">
								<img src="${data.imageUrl}" class="modalImage" alt="IMG-PRODUCT" style="width:600px;height:600px">
								<a class="flex-c-m size-108 how-pos1 bor0 fs-16 cl10 bg0 hov-btn3 trans-04 modalImageLink" href="${data.imageUrl}">
									<i class="fa fa-expand"></i>
								</a>
							</div>
						</div>`
					);
				},
				error: function () {
					alert("Ürün detayları alınamadı.");
				}
			});
		});

		// Modalı kapatma
		$(".js-hide-modal1").on("click", function () {
			$(".js-modal1").removeClass("show-modal");
		});
	});


</script>
